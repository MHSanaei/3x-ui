{{define "form/vless"}}
<a-collapse activeKey="0" v-for="(client, index) in inbound.settings.vlesses.slice(0,1)" v-if="!isEdit">
  <a-collapse-panel header='{{ i18n "pages.inbounds.client" }}'>
    {{template "form/client"}}
  </a-collapse-panel>
</a-collapse>
<a-collapse v-else>
  <a-collapse-panel :header="'{{ i18n "pages.client.clientCount"}} : ' + inbound.settings.vlesses.length">
    <table width="100%">
      <tr class="client-table-header">
        <th>{{ i18n "pages.inbounds.email" }}</th>
        <th>ID</th>
      </tr>
      <tr v-for="(client, index) in inbound.settings.vlesses" :class="index % 2 == 1 ? 'client-table-odd-row' : ''">
        <td>[[ client.email ]]</td>
        <td>[[ client.id ]]</td>
      </tr>
    </table>
  </a-collapse-panel>
</a-collapse>
<template v-if="!inbound.stream.isTLS || !inbound.stream.isReality">
  <a-form :colon="false" :label-col="{ md: {span:8} }" :wrapper-col="{ md: {span:14} }">
    <a-form-item label="Authentication">
      <a-select v-model="inbound.settings.selectedAuth" @change="getNewVlessEnc" :dropdown-class-name="themeSwitcher.currentTheme">
        <a-select-option value="X25519, not Post-Quantum">X25519 (not Post-Quantum)</a-select-option>
        <a-select-option value="ML-KEM-768, Post-Quantum">ML-KEM-768 (Post-Quantum)</a-select-option>
      </a-select>
    </a-form-item>
    <a-form-item label="decryption">
      <a-input v-model.trim="inbound.settings.decryption"></a-input>
    </a-form-item>
    <a-form-item label="encryption">
      <a-input v-model="inbound.settings.encryption"></a-input>
    </a-form-item>
    <a-form-item label=" ">
      <a-space>
        <a-button type="primary" icon="import" @click="getNewVlessEnc">Get New keys</a-button>
        <a-button danger @click="clearVlessEnc">Clear</a-button>
      </a-space>
    </a-form-item>
  </a-form>
</template>
<template v-if="inbound.isTcp && !inbound.settings.selectedAuth">
  <a-form :colon="false" :label-col="{ md: {span:8} }" :wrapper-col="{ md: {span:14} }">
    <a-form-item label="Fallbacks">
      <a-button icon="plus" type="primary" size="small" @click="inbound.settings.addFallback()"></a-button>
    </a-form-item>
  </a-form>

  <!-- vless fallbacks -->
  <a-form v-for="(fallback, index) in inbound.settings.fallbacks" :colon="false" :label-col="{ md: {span:8} }" :wrapper-col="{ md: {span:14} }">
    <a-divider :style="{ margin: '0' }"> Fallback [[ index + 1 ]] <a-icon type="delete" @click="() => inbound.settings.delFallback(index)" :style="{ color: 'rgb(255, 77, 79)', cursor: 'pointer' }"></a-icon>
    </a-divider>
    <a-form-item label='SNI'>
      <a-input v-model="fallback.name"></a-input>
    </a-form-item>
    <a-form-item label='ALPN'>
      <a-input v-model="fallback.alpn"></a-input>
    </a-form-item>
    <a-form-item label='Path'>
      <a-input v-model="fallback.path"></a-input>
    </a-form-item>
    <a-form-item label='Dest'>
      <a-input v-model="fallback.dest"></a-input>
    </a-form-item>
    <a-form-item label='xVer'>
      <a-input-number v-model.number="fallback.xver" :min="0" :max="2"></a-input-number>
    </a-form-item>
  </a-form>
  <a-divider :style="{ margin: '5px 0' }"></a-divider>
</template>
{{end}}
